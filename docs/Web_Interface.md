# NexCode Web 界面使用指南

## 📱 界面概览

NexCode Web 界面提供了直观的聊天体验，支持双模式 AI 对话：
- **服务器配置模式** - 使用服务器预配置的 API Key 调用 OpenAI
- **用户 API Key 模式** - 用户提供自己的 OpenAI API Key，支持自定义模型和参数

## 🔐 登录认证

### 支持的登录方式

1. **用户名/密码登录**
   - 演示账号：`demo` / `demo123`
   - 管理员账号：`admin` / `admin123`

2. **CAS 统一认证** (如果配置)
   - 点击"统一认证"标签页
   - 系统会跳转到 CAS 认证页面

### 登录界面功能

- 🔄 **双认证模式** - 密码登录和 CAS 登录切换
- 👁️ **密码可见性** - 点击眼睛图标切换密码显示
- ✅ **表单验证** - 实时验证用户输入
- 🔄 **自动重定向** - 登录成功后自动跳转到聊天页面

## 💬 聊天界面

### 主要功能

1. **智能对话**
   - 支持多轮对话，自动维护上下文
   - 实时响应，流畅的交互体验
   - 消息时间戳显示

2. **双模式支持**
   - **服务器配置模式** - 默认使用服务器配置的 OpenAI API Key
   - **用户 API Key 模式** - 用户自定义 API Key 和模型参数

3. **设置面板**
   - 点击右上角 ⚙️ 图标打开设置
   - 动态配置，无需刷新页面

### 设置选项

#### 基础设置
- **API Key 模式** - 勾选"使用用户 API Key（而非服务器配置）"切换模式

#### 用户自定义配置 (当启用用户 API Key 模式时)

1. **API Key 设置**
   - 🔑 输入您的 OpenAI API Key (sk-...)
   - 密码类型输入框，保护密钥安全
   - 必须提供有效 API Key 才能发送消息

2. **模型选择**
   ```
   GPT-3.5 Turbo  - 快速响应，经济实用
   GPT-4          - 更强推理能力
   GPT-4 Turbo    - 最新最强模型
   ```

3. **温度控制**
   - 范围：0.0 - 2.0
   - 默认值：0.7
   - 说明：
     - 0.0 - 1.0：更加确定和一致的回答
     - 1.0 - 2.0：更有创意和多样性的回答

### 消息界面

1. **消息显示**
   - 👤 用户消息：右侧显示，蓝色背景
   - 🤖 AI 回复：左侧显示，灰色背景
   - ⏰ 时间戳：每条消息显示发送时间

2. **输入区域**
   - 📝 多行文本输入框，支持 Shift+Enter 换行
   - 🚀 发送按钮，Enter 键快速发送
   - 🔒 智能禁用：在 OpenAI 模式下未设置 API Key 时禁用

3. **状态提示**
   - ⏳ "AI 正在思考..." 加载状态
   - 🎯 当前模式显示 (内置/OpenAI)
   - ❌ 错误提示和处理

## 🔧 高级功能

### 对话历史管理

- **上下文维护**：自动保持最近 10 条消息作为对话上下文
- **会话持久化**：刷新页面后对话记录保持
- **内存优化**：自动清理过长的对话历史

### 响应式设计

- 📱 **移动端适配** - 在手机和平板上良好显示
- 💻 **桌面端优化** - 大屏幕下充分利用空间
- 🎨 **主题统一** - 与整体设计风格保持一致

## 🌟 使用技巧

### 最佳实践

1. **选择合适的模式**
   - 日常使用：使用服务器配置模式，无需管理 API Key
   - 自定义需求：切换到用户 API Key 模式，使用 GPT-4 等高级模型
   - 成本控制：用户 API Key 模式可以直接控制费用

2. **优化对话效果**
   - 提供清晰、具体的问题描述
   - 适当调整温度参数
   - 利用系统自动维护的上下文

3. **API Key 管理**
   - 使用环境变量存储长期使用的 API Key
   - 定期检查 API Key 使用量和余额
   - 不要在公共环境中暴露 API Key

### 常用场景

1. **编程助手**
   ```
   用户: 如何在 Python 中实现单例模式？
   AI: [提供详细的代码示例和解释]
   ```

2. **代码审查**
   ```
   用户: 请审查这段代码：[粘贴代码]
   AI: [分析代码质量、指出问题、提供改进建议]
   ```

3. **问题解决**
   ```
   用户: 我遇到了这个错误：[错误信息]
   AI: [分析错误原因，提供解决方案]
   ```

## 🔍 故障排除

### 界面问题

**登录后没有跳转到聊天页面**
- 清除浏览器缓存和 localStorage
- 检查浏览器控制台是否有错误信息
- 确认后端服务正常运行

**设置面板无法打开**
- 刷新页面重试
- 检查浏览器 JavaScript 是否启用
- 查看浏览器控制台错误

**消息发送失败**
- 检查网络连接
- 验证 API Key 是否正确 (OpenAI 模式)
- 确认后端服务状态

### OpenAI 相关问题

**"请先设置 OpenAI API Key" 提示**
- 在设置面板中输入有效的 OpenAI API Key
- 确认 API Key 格式正确 (以 sk- 开头)

**API 调用失败**
- 检查 API Key 是否有效且有余额
- 验证网络能否访问 OpenAI 服务
- 尝试降低 max_tokens 参数

## 📚 技术架构

### 前端技术栈

- **Next.js 14** - React 框架，支持 SSR
- **TypeScript** - 类型安全的 JavaScript
- **Tailwind CSS** - 实用优先的 CSS 框架
- **Zustand** - 轻量级状态管理
- **Framer Motion** - 动画库
- **React Hot Toast** - 消息提示

### 关键组件

1. **认证模块** (`authStore.ts`)
   - 处理登录/登出逻辑
   - 管理用户会话状态
   - 支持双认证模式

2. **API 客户端** (`api.ts`)
   - 统一的 HTTP 请求管理
   - 自动认证令牌注入
   - 错误处理和重试

3. **聊天组件** (`Chat.tsx`)
   - 双模式 AI 对话支持
   - 实时消息渲染
   - 设置面板集成

## 🔄 更新日志

### v1.2.0 (当前版本)
- ✅ 新增 OpenAI Chat Completion 接口支持
- ✅ 动态模型和参数配置
- ✅ 改进的设置面板 UI
- ✅ 修复登录重定向问题
- ✅ 响应式设计优化

### 未来计划
- 🔄 支持对话导出和分享
- 🎨 自定义主题和布局
- 📊 使用统计和分析
- 🔌 插件系统支持 